<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë…ë„ ì—­ì‚¬ ì—°ëŒ€ê¸°: ì§„ì‹¤ì˜ ê¸°ë¡</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&family=Noto+Serif+KR:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; background-color: #fcfbf9; color: #2d3748; }
        h1, h2, h3, .serif { font-family: 'Noto Serif KR', serif; }
        .timeline-line { position: absolute; left: 50%; transform: translateX(-50%); width: 2px; height: 100%; background-color: #e2e8f0; z-index: 0; }
        .timeline-card { transition: all 0.3s ease; }
        .timeline-card:hover { transform: translateY(-5px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); }
        .chart-container { position: relative; width: 100%; max-width: 600px; margin: 0 auto; height: 300px; max-height: 400px; }
        
        /* Animation Classes */
        .fade-in-section { opacity: 0; transform: translateY(20px); transition: opacity 0.6s ease-out, transform 0.6s ease-out; will-change: opacity, visibility; }
        .fade-in-section.is-visible { opacity: 1; transform: none; }
        
        /* Year Ribbon Scrollbar */
        .year-ribbon::-webkit-scrollbar { height: 6px; }
        .year-ribbon::-webkit-scrollbar-track { background: #f1f1f1; }
        .year-ribbon::-webkit-scrollbar-thumb { background: #93c5fd; border-radius: 3px; }
        .year-ribbon::-webkit-scrollbar-thumb:hover { background: #3b82f6; }

        @media (min-width: 768px) { .chart-container { height: 350px; } }
    </style>
    <!-- Chosen Palette: Warm Historical (Neutral Beige Background, Navy Blue for Trust/Sea, Muted Red for Emphasis, Gold for Highlights) -->
</head>
<body class="bg-stone-50 text-stone-800">

    <!-- Navigation / Header -->
    <header class="bg-white border-b border-stone-200 sticky top-0 z-50 shadow-sm">
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
            <div class="flex items-center space-x-2 cursor-pointer" onclick="window.scrollTo({top:0, behavior:'smooth'})">
                <span class="text-2xl font-bold text-blue-900 serif">ë…ë„</span>
                <span class="text-lg text-stone-500 serif">ì—­ì‚¬ì˜ ì§„ì‹¤</span>
            </div>
            
            <div class="flex items-center gap-2 md:gap-6">
                <nav class="hidden md:flex space-x-6 text-sm font-medium text-stone-600">
                    <a href="#overview" class="hover:text-blue-800 transition">ê°œìš” ë° í†µê³„</a>
                    <a href="#timeline" class="hover:text-blue-800 transition">ì—­ì‚¬ ì—°ëŒ€ê¸°</a>
                    <a href="#archive" class="hover:text-blue-800 transition">ìë£Œ ì•„ì¹´ì´ë¸Œ</a>
                </nav>

                <!-- Home Button -->
                <a href="index.html" class="text-stone-600 hover:text-blue-900 p-2 rounded-full hover:bg-stone-100 transition" title="í™ˆìœ¼ë¡œ ì´ë™">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                        <polyline points="9 22 9 12 15 12 15 22"></polyline>
                    </svg>
                </a>

                <button onclick="scrollToTop()" class="md:hidden text-stone-600 p-2">
                    â–²
                </button>
            </div>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="bg-blue-900 text-white py-16 px-4 text-center relative overflow-hidden">
        <div class="relative z-10 max-w-3xl mx-auto fade-in-section is-visible">
            <h1 class="text-4xl md:text-5xl font-bold mb-6 leading-tight">ëŒ€í•œë¯¼êµ­ ë…ë„,<br>ê¸°ë¡ìœ¼ë¡œ ì¦ëª…ëœ ìš°ë¦¬ ë•…</h1>
            <p class="text-blue-100 text-lg md:text-xl mb-8 font-light">
                1454ë…„ ì„¸ì¢…ì‹¤ë¡ì§€ë¦¬ì§€ë¶€í„° í˜„ëŒ€ì— ì´ë¥´ê¸°ê¹Œì§€.<br>
                ë³€í•˜ì§€ ì•ŠëŠ” ì—­ì‚¬ì˜ ê¸°ë¡ë“¤ì„ í†µí•´ ë…ë„ì˜ ì§„ì‹¤ì„ í™•ì¸í•´ë³´ì„¸ìš”.
            </p>
            <a href="#timeline" class="inline-block bg-amber-600 hover:bg-amber-700 text-white font-bold py-3 px-8 rounded-full transition shadow-lg">
                ì—°ëŒ€ê¸° íƒí—˜í•˜ê¸°
            </a>
        </div>
        <div class="absolute top-0 left-0 w-full h-full bg-blue-950 opacity-50 z-0"></div>
    </section>

    <main class="container mx-auto px-4 py-12 space-y-20">

        <!-- 1. Analytical Overview Section -->
        <section id="overview" class="scroll-mt-24">
            <div class="text-center mb-10 max-w-2xl mx-auto fade-in-section">
                <h2 class="text-3xl font-bold text-stone-800 mb-4">ì—­ì‚¬ì  í†µê³„ ë° ë¶„ì„</h2>
                <p class="text-stone-600">
                    ë…ë„ì™€ ê´€ë ¨ëœ ì—­ì‚¬ì  ì‚¬ê±´ë“¤ì€ ë‹¨ìˆœí•œ ë‚˜ì—´ì´ ì•„ë‹™ë‹ˆë‹¤. 
                    ìˆ˜ë°± ë…„ì— ê±¸ì¹œ <strong>ëŒ€í•œë¯¼êµ­ì˜ ì‹¤íš¨ì  ì§€ë°° ê¸°ë¡</strong>ê³¼ ê·¼ëŒ€ ì´í›„ <strong>ì¼ë³¸ì˜ ì¹¨íƒˆ ì‹œë„</strong>ë¥¼ 
                    ë°ì´í„° ì‹œê°í™”ë¥¼ í†µí•´ í•œëˆˆì— íŒŒì•…í•´ ë´…ë‹ˆë‹¤.
                    <br><span class="text-sm text-blue-600 mt-2 inline-block">â€» ì°¨íŠ¸ë¥¼ í´ë¦­í•˜ë©´ í•´ë‹¹ ìœ í˜•/ì‹œê¸°ì˜ ì‚¬ê±´ì„ íƒ€ì„ë¼ì¸ì—ì„œ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</span>
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-start fade-in-section">
                <!-- Chart 1: Event Types -->
                <div class="bg-white p-6 rounded-xl shadow-md border border-stone-100 hover:shadow-lg transition cursor-pointer group">
                    <h3 class="text-xl font-bold text-center mb-2 text-stone-700 group-hover:text-blue-700">ì‚¬ê±´ ì„±ê²©ë³„ ë¶„í¬</h3>
                    <p class="text-xs text-center text-stone-500 mb-6">ì „ì²´ ê¸°ë¡ ì¤‘ ìš°ë¦¬ ì˜í†  ì…ì¦ ê¸°ë¡ê³¼ ë¶„ìŸ ì‚¬ê±´ì˜ ë¹„ìœ¨</p>
                    <div class="chart-container">
                        <canvas id="eventTypeChart"></canvas>
                    </div>
                </div>

                <!-- Chart 2: Timeline Density -->
                <div class="bg-white p-6 rounded-xl shadow-md border border-stone-100 hover:shadow-lg transition cursor-pointer group">
                    <h3 class="text-xl font-bold text-center mb-2 text-stone-700 group-hover:text-amber-700">ì‹œëŒ€ë³„ ì£¼ìš” ì‚¬ê±´ ë¹ˆë„</h3>
                    <p class="text-xs text-center text-stone-500 mb-6">15ì„¸ê¸°ë¶€í„° 21ì„¸ê¸°ê¹Œì§€ì˜ ê¸°ë¡ ì§‘ì¤‘ë„ ë¶„ì„</p>
                    <div class="chart-container">
                        <canvas id="timelineDensityChart"></canvas>
                    </div>
                </div>
            </div>
            
            <!-- Quick Stats Cards -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-8 fade-in-section">
                <div class="bg-blue-50 p-4 rounded-lg text-center border border-blue-100">
                    <div class="text-2xl font-bold text-blue-800" id="totalEvents">0</div>
                    <div class="text-xs text-blue-600 font-medium">ì´ ê¸°ë¡ëœ ì‚¬ê±´</div>
                </div>
                <div class="bg-amber-50 p-4 rounded-lg text-center border border-amber-100">
                    <div class="text-2xl font-bold text-amber-800">1454</div>
                    <div class="text-xs text-amber-600 font-medium">ìµœì´ˆ ê¸°ë¡ ì—°ë„</div>
                </div>
                <div class="bg-emerald-50 p-4 rounded-lg text-center border border-emerald-100">
                    <div class="text-2xl font-bold text-emerald-800">10+</div>
                    <div class="text-xs text-emerald-600 font-medium">ì‹¤íš¨ ì§€ë°° ì¦ê±°</div>
                </div>
                <div class="bg-red-50 p-4 rounded-lg text-center border border-red-100">
                    <div class="text-2xl font-bold text-red-800">1905</div>
                    <div class="text-xs text-red-600 font-medium">ë¶ˆë²• í¸ì… ì‹œë„</div>
                </div>
            </div>
        </section>

        <!-- 2. Interactive Timeline Section -->
        <section id="timeline" class="scroll-mt-24 relative">
            <div class="text-center mb-4 max-w-3xl mx-auto fade-in-section">
                <h2 class="text-3xl font-bold text-stone-800 mb-4">ì¸í„°ë™í‹°ë¸Œ ì—­ì‚¬ ì—°ëŒ€ê¸°</h2>
                <p class="text-stone-600">
                    ì¡°ì„ ì‹œëŒ€ë¶€í„° í˜„ëŒ€ê¹Œì§€, ë…ë„ë¥¼ ë‘˜ëŸ¬ì‹¼ ì£¼ìš” ì‚¬ê±´ë“¤ì„ íƒìƒ‰í•˜ì„¸ìš”.
                </p>
                <div id="activeFilterDisplay" class="hidden mt-2 inline-block px-4 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-bold">
                    í•„í„° ì ìš© ì¤‘: <span id="filterName"></span>
                    <button onclick="resetFilter()" class="ml-2 text-blue-500 hover:text-blue-700">âœ•</button>
                </div>
            </div>

            <!-- Sticky Year Ribbon (New Feature) -->
            <div class="sticky top-[73px] z-40 bg-white/95 backdrop-blur-sm border-y border-stone-200 py-3 mb-12 shadow-sm">
                <div class="container mx-auto px-4">
                    <div class="flex items-center">
                        <span class="text-xs font-bold text-stone-500 mr-4 whitespace-nowrap">ì—°ë„ ë°”ë¡œê°€ê¸°:</span>
                        <div class="flex overflow-x-auto gap-2 pb-1 year-ribbon no-scrollbar" id="yearRibbon">
                            <!-- Year buttons injected by JS -->
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Filter Tabs -->
            <div class="flex flex-wrap justify-center gap-2 mb-12 fade-in-section">
                <button onclick="filterTimeline('all')" class="filter-btn active px-6 py-2 rounded-full text-sm font-semibold transition bg-blue-900 text-white hover:bg-blue-800 shadow-md ring-2 ring-offset-2 ring-blue-900" data-filter="all">ì „ì²´ ë³´ê¸°</button>
                <button onclick="filterTimeline('joseon')" class="filter-btn px-6 py-2 rounded-full text-sm font-semibold transition bg-white text-stone-600 border border-stone-300 hover:bg-stone-100" data-filter="joseon">ì¡°ì„ ì‹œëŒ€ (1454-1899)</button>
                <button onclick="filterTimeline('modern')" class="filter-btn px-6 py-2 rounded-full text-sm font-semibold transition bg-white text-stone-600 border border-stone-300 hover:bg-stone-100" data-filter="modern">ëŒ€í•œì œêµ­/ì¼ì œê°•ì ê¸° (1900-1945)</button>
                <button onclick="filterTimeline('contemporary')" class="filter-btn px-6 py-2 rounded-full text-sm font-semibold transition bg-white text-stone-600 border border-stone-300 hover:bg-stone-100" data-filter="contemporary">ê´‘ë³µ ì´í›„/í˜„ëŒ€ (1946-í˜„ì¬)</button>
            </div>

            <!-- Vertical Timeline Container -->
            <div class="relative container mx-auto px-4 max-w-4xl min-h-[500px]" id="timelineContainer">
                <div class="timeline-line hidden md:block"></div>
                <!-- Timeline items will be injected here by JS -->
            </div>
        </section>

        <!-- 3. Detailed Archive Table Section -->
        <section id="archive" class="bg-white rounded-2xl shadow-lg border border-stone-200 p-8 scroll-mt-24 fade-in-section">
            <div class="flex flex-col md:flex-row justify-between items-center mb-8">
                <div>
                    <h2 class="text-2xl font-bold text-stone-800">ì „ì²´ ìë£Œ ì•„ì¹´ì´ë¸Œ</h2>
                    <p class="text-sm text-stone-500 mt-1">ëª¨ë“  ì—°ëŒ€ê¸° ë°ì´í„°ë¥¼ ê²€ìƒ‰í•˜ê³  í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                </div>
                <div class="mt-4 md:mt-0 w-full md:w-auto">
                    <div class="relative">
                        <input type="text" id="searchInput" placeholder="ì—°ë„, ì‚¬ê±´, ë‚´ìš© ê²€ìƒ‰..." class="w-full md:w-64 pl-4 pr-10 py-2 border border-stone-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm">
                        <span class="absolute right-3 top-2.5 text-stone-400 font-bold">ğŸ”</span>
                    </div>
                </div>
            </div>

            <div class="overflow-x-auto">
                <table class="w-full text-left border-collapse">
                    <thead>
                        <tr class="bg-stone-100 text-stone-700 text-sm uppercase tracking-wider border-b border-stone-200">
                            <th class="p-4 font-bold w-24 text-center">ì—°ë„</th>
                            <th class="p-4 font-bold w-1/4">ì£¼ìš” ì‚¬ê±´</th>
                            <th class="p-4 font-bold">ë‚´ìš© ë° ì˜ë¯¸</th>
                            <th class="p-4 font-bold w-24 text-center">ì¶œì²˜</th>
                        </tr>
                    </thead>
                    <tbody id="archiveTableBody" class="text-stone-600 text-sm divide-y divide-stone-100">
                        <!-- Table rows injected by JS -->
                    </tbody>
                </table>
            </div>
            <div id="noResults" class="hidden text-center py-8 text-stone-500">
                ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.
            </div>
        </section>

    </main>

    <footer class="bg-stone-800 text-stone-400 py-8 mt-12">
        <div class="container mx-auto px-4 text-center">
            <p class="font-serif text-stone-300 mb-2">ë…ë„ëŠ” ëŒ€í•œë¯¼êµ­ì˜ ê³ ìœ  ì˜í† ì…ë‹ˆë‹¤.</p>
            <p class="text-xs">&copy; 2024 Dokdo Historical Archive Project. Based on provided source reports.</p>
        </div>
    </footer>

    <script>
        // --- DATA STORAGE ---
        const dokdoData = [
            { id: 1, year: 1454, event: "ì„¸ì¢…ì‹¤ë¡ì§€ë¦¬ì§€", content: "ìš°ì‚°(ë…ë„)ê³¼ ë¬´ë¦‰(ìš¸ë¦‰ë„)ì´ ê°•ì›ë„ ìš¸ì§„í˜„ì— ì†í•œë‹¤ê³  ê¸°ë¡í•˜ë©° ë…ë„ê°€ ì¡°ì„ ì˜ ì˜í† ì„ì„ ëª…ì‹œí•¨", source: "[1]", category: "joseon", type: "record_kr" },
            { id: 2, year: 1531, event: "ì‹ ì¦ë™êµ­ì—¬ì§€ìŠ¹ëŒ", content: "ë…ë„ê°€ ìš°ë¦¬ ì˜í† ì„ì„ ë°íˆëŠ” ê´€ì°¬ ì§€ë¦¬ì§€ í¸ì°¬", source: "[2]", category: "joseon", type: "record_kr" },
            { id: 3, year: 1667, event: "ì€ì£¼ì‹œì²­í•©ê¸°", content: "ì¼ë³¸ì˜ ë¬¸í—Œìœ¼ë¡œ, ìš¸ë¦‰ë„ì™€ ë…ë„ê°€ ì¼ë³¸ ì˜í†  ë°–(ì¡°ì„  ë•…)ì„ì„ ê¸°ë¡í•˜ì—¬ ì¼ë³¸ ìŠ¤ìŠ¤ë¡œ ë…ë„ë¥¼ ì œì™¸í•¨", source: "[3]", category: "joseon", type: "record_jp_recognition" },
            { id: 4, year: 1693, event: "1ì°¨ ì•ˆìš©ë³µ ì‚¬ê±´", content: "ì•ˆìš©ë³µì´ ì¼ë³¸ìœ¼ë¡œ ëŒë ¤ê°€ ë…ë„ê°€ ì¡°ì„  ë•…ì„ì„ ê°•ë ¥íˆ ì£¼ì¥í•¨", source: "[4]", category: "joseon", type: "action_kr" },
            { id: 5, year: 1696, event: "2ì°¨ ì•ˆìš©ë³µ ì‚¬ê±´", content: "ì•ˆìš©ë³µì´ ì¼ë³¸ì— ê±´ë„ˆê°€ ë¶ˆë²• ì¹¨ë²”ì— í•­ì˜í•˜ì˜€ê³ , ì´ì— ì¼ë³¸ ë§‰ë¶€ê°€ 'ìš¸ë¦‰ë„ ë„í•´ ê¸ˆì§€ë ¹'ì„ ë‚´ë¦¼", source: "[5]", category: "joseon", type: "action_kr" },
            { id: 6, year: 1785, event: "ì‚¼êµ­ì ‘ì–‘ì§€ë„", content: "ì¼ë³¸ í•˜ì•¼ì‹œ ì‹œí—¤ì´ê°€ ì œì‘í•œ ì§€ë„ë¡œ, ë…ë„ë¥¼ ì¡°ì„ ìƒ‰(í™©ìƒ‰)ìœ¼ë¡œ ì¹ í•˜ê³  'ì¡°ì„ ì˜ ê²ƒ'ì´ë¼ ëª…í™•íˆ í‘œê¸°í•¨", source: "[6]", category: "joseon", type: "record_jp_recognition" },
            { id: 7, year: 1877, event: "íƒœì •ê´€ ì§€ë ¹", content: "ì¼ë³¸ ìµœê³  í–‰ì •ê¸°ê´€ì¸ íƒœì •ê´€ì´ 'ë…ë„ì™€ ìš¸ë¦‰ë„ëŠ” ì¼ë³¸ê³¼ ê´€ê³„ì—†ë‹¤'ê³  ê³µì‹ì ìœ¼ë¡œ ì¸ì •í•¨", source: "[7]", category: "joseon", type: "record_jp_recognition" },
            { id: 8, year: 1900, event: "ëŒ€í•œì œêµ­ ì¹™ë ¹ 41í˜¸", content: "ê³ ì¢… í™©ì œê°€ ë…ë„ë¥¼ ìš¸ë¦‰êµ°ì˜ ê´€í•  êµ¬ì—­ìœ¼ë¡œ ê³µì‹ ë°˜í¬í•˜ì—¬ ê·¼ëŒ€ë²•ì ìœ¼ë¡œ ì˜ìœ ê¶Œì„ í™•ë¦½í•¨", source: "[8]", category: "modern", type: "action_kr" },
            { id: 9, year: 1905, event: "ì‹œë§ˆë„¤í˜„ ê³ ì‹œ 40í˜¸", content: "ì¼ë³¸ì´ ëŸ¬ì¼ì „ìŸ ì¤‘ ë…ë„ë¥¼ êµ°ì‚¬ì  ëª©ì ìœ¼ë¡œ ë¶ˆë²•ì ìœ¼ë¡œ 'ë‹¤ì¼€ì‹œë§ˆ'ë¡œ í¸ì…í•¨", source: "[9]", category: "modern", type: "aggression_jp" },
            { id: 10, year: 1906, event: "ì‹¬í¥íƒ ë³´ê³ ì„œ", content: "ìš¸ë¦‰êµ°ìˆ˜ ì‹¬í¥íƒì´ ë…ë„ê°€ ì¼ë³¸ì— í¸ì…ë˜ì—ˆë‹¤ëŠ” ì†Œì‹ì„ ë“£ê³  ì¦‰ì‹œ ì¤‘ì•™ ì •ë¶€ì— ë³´ê³ í•¨", source: "[8]", category: "modern", type: "action_kr" },
            { id: 11, year: 1946, event: "SCAPIN ì œ677í˜¸", content: "ì—°í•©êµ°ìµœê³ ì‚¬ë ¹ê´€ ì§€ë ¹ìœ¼ë¡œ ë…ë„ë¥¼ ì¼ë³¸ì˜ í†µì¹˜ê¶Œ ë° ì˜í† ì—ì„œ ì œì™¸í•¨", source: "[10]", category: "contemporary", type: "international" },
            { id: 12, year: 1951, event: "ìƒŒí”„ë€ì‹œìŠ¤ì½” ê°•í™”ì¡°ì•½", content: "ì¼ë³¸ì´ í•œêµ­ì˜ ë…ë¦½ì„ ì¸ì •í–ˆìœ¼ë‚˜, ë…ë„ì— ëŒ€í•œ ëª…ì‹œê°€ ëˆ„ë½ë˜ì–´ ì´í›„ ë¶„ìŸì˜ ì”¨ì•—ì´ ë¨", source: "[11]", category: "contemporary", type: "international" },
            { id: 13, year: 1952, event: "í‰í™”ì„  ì„ í¬", content: "ì´ìŠ¹ë§Œ ëŒ€í†µë ¹ì´ ë…ë„ë¥¼ í¬í•¨í•œ ì¸ì ‘ í•´ì–‘ ì£¼ê¶Œì„ ì„ ì–¸í•¨ (ì°¸ê³ : ì¼ë¶€ ìë£Œì—ëŠ” 1951ë…„ìœ¼ë¡œ í‘œê¸°ë¨)", source: "[12]", category: "contemporary", type: "action_kr" },
            { id: 14, year: 1953, event: "ë…ë„ì˜ìš©ìˆ˜ë¹„ëŒ€ í™œë™", content: "í™ìˆœì¹  ëŒ€ì¥ ë“± ë¯¼ê°„ì¸ë“¤ì´ ë…ë„ì— ìƒì£¼í•˜ë©° ë¬´ì¥ ìˆœì°°ì„ í†µí•´ ì¼ë³¸ì˜ ì¹¨ë²”ì„ ë§‰ì•„ëƒ„", source: "[13], [14]", category: "contemporary", type: "action_kr" },
            { id: 15, year: 1965, event: "í•œì¼ê¸°ë³¸ì¡°ì•½", content: "ë…ë„ ë¬¸ì œë¥¼ êµ¬ì²´ì ìœ¼ë¡œ ì–¸ê¸‰í•˜ì§€ ì•Šê³  ë´‰í•©í•˜ì—¬ ì´í›„ ê°ˆë“±ì˜ ë¶ˆì”¨ê°€ ë‚¨ìŒ", source: "[15]", category: "contemporary", type: "international" },
            { id: 16, year: 1998, event: "ì‹ í•œì¼ì–´ì—…í˜‘ì •", content: "ë…ë„ê°€ í•œì¼ ì¤‘ê°„ìˆ˜ì—­ì— í¬í•¨ë˜ë©´ì„œ ì˜ìœ ê¶Œ ë° ì–´ì—…ê¶Œ ê´€ë ¨ ë…¼ë€ì´ ë°œìƒí•¨", source: "[16]", category: "contemporary", type: "international" },
            { id: 17, year: 2005, event: "ë‹¤ì¼€ì‹œë§ˆì˜ ë‚  ì œì •", content: "ì¼ë³¸ ì‹œë§ˆë„¤í˜„ì´ 1905ë…„ í¸ì…ì¼ì„ ê·¼ê±°ë¡œ 2ì›” 22ì¼ì„ 'ë‹¤ì¼€ì‹œë§ˆì˜ ë‚ 'ë¡œ ì œì •í•¨", source: "[17]", category: "contemporary", type: "aggression_jp" },
            { id: 18, year: 2011, event: "ì¼ë³¸ êµê³¼ì„œ ì™œê³¡", content: "ì¼ë³¸ ì¤‘í•™êµ êµê³¼ì„œ 14ì¢…ì— ë…ë„ ì˜ìœ ê¶Œ ì£¼ì¥ì´ ê¸°ìˆ ë˜ë©° ì—­ì‚¬ ì™œê³¡ ì‹¬í™”", source: "[18]", category: "contemporary", type: "aggression_jp" }
        ];

        // --- STATE MANAGEMENT ---
        let currentFilter = 'all';
        let timelineDensityChartInstance = null;
        let eventTypeChartInstance = null;
        
        // --- UTILITY FUNCTIONS ---
        function getCategoryColor(type) {
            switch(type) {
                case 'record_kr': return 'bg-blue-100 text-blue-800 border-blue-200';
                case 'action_kr': return 'bg-indigo-100 text-indigo-800 border-indigo-200';
                case 'record_jp_recognition': return 'bg-emerald-100 text-emerald-800 border-emerald-200';
                case 'aggression_jp': return 'bg-red-100 text-red-800 border-red-200';
                case 'international': return 'bg-stone-200 text-stone-800 border-stone-300';
                default: return 'bg-gray-100 text-gray-800';
            }
        }

        function getCategoryLabel(type) {
             switch(type) {
                case 'record_kr': return 'ìš°ë¦¬ì¸¡ ê¸°ë¡';
                case 'action_kr': return 'ìš°ë¦¬ì¸¡ ì¡°ì¹˜/í™œë™';
                case 'record_jp_recognition': return 'ì¼ë³¸ì¸¡ ê¸°ë¡/ì¸ì •';
                case 'aggression_jp': return 'ì¼ë³¸ì¸¡ ë„ë°œ/ì¹¨íƒˆ';
                case 'international': return 'êµ­ì œ ì¡°ì•½/ê¸°íƒ€';
                default: return 'ê¸°íƒ€';
            }
        }

        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        function scrollToYear(year) {
            const element = document.getElementById(`event-${year}`);
            if (element) {
                // Adjust for sticky header
                const headerOffset = 180; 
                const elementPosition = element.getBoundingClientRect().top;
                const offsetPosition = elementPosition + window.pageYOffset - headerOffset;
            
                window.scrollTo({
                    top: offsetPosition,
                    behavior: "smooth"
                });
                
                // Highlight effect
                element.querySelector('.timeline-card').classList.add('ring-4', 'ring-amber-400');
                setTimeout(() => {
                    element.querySelector('.timeline-card').classList.remove('ring-4', 'ring-amber-400');
                }, 1500);
            } else {
                // If filtered out, reset filter then scroll
                if(currentFilter !== 'all') {
                    resetFilter();
                    setTimeout(() => scrollToYear(year), 300);
                }
            }
        }

        // --- OBSERVER FOR ANIMATION ---
        const observerOptions = {
            root: null,
            rootMargin: '0px',
            threshold: 0.1
        };

        const observer = new IntersectionObserver((entries, observer) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('is-visible');
                    // Optional: Stop observing once visible to animate only once
                    // observer.unobserve(entry.target); 
                }
            });
        }, observerOptions);

        function setupAnimations() {
            const elements = document.querySelectorAll('.fade-in-section');
            elements.forEach(el => observer.observe(el));
        }

        // --- RENDER FUNCTIONS ---
        
        function renderYearRibbon(data) {
            const ribbon = document.getElementById('yearRibbon');
            ribbon.innerHTML = '';
            
            data.forEach(item => {
                const btn = document.createElement('button');
                btn.className = 'flex-shrink-0 px-3 py-1 bg-stone-100 hover:bg-blue-100 hover:text-blue-700 text-stone-600 text-xs font-bold rounded-full transition border border-stone-200';
                btn.innerText = item.year;
                btn.onclick = () => scrollToYear(item.year);
                ribbon.appendChild(btn);
            });
        }

        function renderTimeline(filter, filterMode = 'category') {
            const container = document.getElementById('timelineContainer');
            const line = container.querySelector('.timeline-line');
            container.innerHTML = '';
            container.appendChild(line);

            let filteredData = dokdoData;
            
            // Logic to handle different filter types (by Tab or by Chart click)
            if (filterMode === 'category') {
                if (filter !== 'all') {
                    filteredData = dokdoData.filter(item => item.category === filter);
                }
            } else if (filterMode === 'century') {
                filteredData = dokdoData.filter(item => {
                    const century = Math.ceil(item.year / 100) + 'ì„¸ê¸°';
                    return century === filter;
                });
            } else if (filterMode === 'type') {
                 // For Doughnut chart mapping (labels to codes)
                 const typeMap = {
                     'ìš°ë¦¬ì¸¡ ê¸°ë¡': 'record_kr',
                     'ìš°ë¦¬ì¸¡ ì¡°ì¹˜': 'action_kr',
                     'ì¼ë³¸ì¸¡ ì¸ì •': 'record_jp_recognition',
                     'ì¼ë³¸ì¸¡ ë„ë°œ': 'aggression_jp',
                     'êµ­ì œ ê´€ê³„': 'international'
                 };
                 // If filter is label, map to code, else use as is
                 const typeCode = typeMap[filter] || filter; 
                 filteredData = dokdoData.filter(item => item.type === typeCode);
            }

            renderYearRibbon(filteredData);

            if (filteredData.length === 0) {
                container.innerHTML += `<div class="text-center py-10 text-stone-500 fade-in-section">í•´ë‹¹ ì¡°ê±´ì˜ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</div>`;
                setupAnimations();
                return;
            }

            filteredData.forEach((item, index) => {
                const isLeft = index % 2 === 0;
                const badgeClass = getCategoryColor(item.type);
                const badgeLabel = getCategoryLabel(item.type);

                const html = `
                    <div id="event-${item.year}" class="flex flex-col md:flex-row items-center justify-between w-full mb-8 relative z-10 timeline-item group fade-in-section">
                        <!-- Spacer for Desktop -->
                        <div class="hidden md:block w-5/12"></div>
                        
                        <!-- Timeline Node -->
                        <div class="absolute left-1/2 transform -translate-x-1/2 w-4 h-4 rounded-full bg-stone-300 border-4 border-white shadow-sm z-20 group-hover:bg-blue-600 group-hover:scale-125 transition duration-300 hidden md:block"></div>
                        
                        <!-- Mobile Node -->
                        <div class="md:hidden flex items-center justify-center w-full mb-2">
                             <div class="w-3 h-3 rounded-full bg-blue-500"></div>
                        </div>

                        <!-- Content Card -->
                        <div class="w-full md:w-5/12 timeline-card bg-white p-6 rounded-lg border border-stone-200 shadow-sm relative ${isLeft ? 'md:mr-auto' : 'md:ml-auto'}">
                            <!-- Arrow (Desktop only) -->
                            <div class="hidden md:block absolute top-1/2 transform -translate-y-1/2 ${isLeft ? '-right-2 border-l-stone-200 border-l-8' : '-left-2 border-r-stone-200 border-r-8'} border-y-8 border-y-transparent w-0 h-0"></div>
                            
                            <div class="flex justify-between items-start mb-2">
                                <span class="text-2xl font-bold text-blue-900 serif">${item.year}</span>
                                <span class="text-xs font-semibold px-2 py-1 rounded border ${badgeClass}">${badgeLabel}</span>
                            </div>
                            <h3 class="text-lg font-bold text-stone-800 mb-2 leading-snug">${item.event}</h3>
                            <p class="text-stone-600 text-sm mb-3 leading-relaxed break-keep">${item.content}</p>
                            <div class="text-xs text-stone-400 text-right">ì¶œì²˜: ${item.source}</div>
                        </div>
                    </div>
                `;
                
                const div = document.createElement('div');
                div.innerHTML = html;
                container.appendChild(div.firstElementChild);
            });
            
            setupAnimations();
        }

        function renderTable(searchTerm = '') {
            const tbody = document.getElementById('archiveTableBody');
            const noResults = document.getElementById('noResults');
            tbody.innerHTML = '';

            const filteredData = dokdoData.filter(item => 
                item.event.toLowerCase().includes(searchTerm.toLowerCase()) || 
                item.content.toLowerCase().includes(searchTerm.toLowerCase()) ||
                item.year.toString().includes(searchTerm)
            );

            if (filteredData.length === 0) {
                noResults.classList.remove('hidden');
            } else {
                noResults.classList.add('hidden');
                filteredData.forEach(item => {
                    const row = `
                        <tr class="hover:bg-blue-50 transition duration-150">
                            <td class="p-4 text-center font-bold text-blue-900">${item.year}</td>
                            <td class="p-4 font-semibold text-stone-800">${item.event}</td>
                            <td class="p-4 leading-relaxed">${item.content}</td>
                            <td class="p-4 text-center text-xs text-stone-500 bg-stone-50 rounded-lg m-2">${item.source}</td>
                        </tr>
                    `;
                    tbody.innerHTML += row;
                });
            }
        }

        // 3. Render Charts
        function initCharts() {
            // Chart 1: Event Type Breakdown
            const typeCounts = {
                'record_kr': 0, 'action_kr': 0, 'record_jp_recognition': 0, 
                'aggression_jp': 0, 'international': 0
            };
            dokdoData.forEach(d => { if(typeCounts[d.type] !== undefined) typeCounts[d.type]++ });

            const ctxType = document.getElementById('eventTypeChart').getContext('2d');
            eventTypeChartInstance = new Chart(ctxType, {
                type: 'doughnut',
                data: {
                    labels: ['ìš°ë¦¬ì¸¡ ê¸°ë¡', 'ìš°ë¦¬ì¸¡ ì¡°ì¹˜', 'ì¼ë³¸ì¸¡ ì¸ì •', 'ì¼ë³¸ì¸¡ ë„ë°œ', 'êµ­ì œ ê´€ê³„'],
                    datasets: [{
                        data: [
                            typeCounts['record_kr'], 
                            typeCounts['action_kr'], 
                            typeCounts['record_jp_recognition'],
                            typeCounts['aggression_jp'],
                            typeCounts['international']
                        ],
                        backgroundColor: ['#93c5fd', '#6366f1', '#34d399', '#f87171', '#d6d3d1'],
                        borderWidth: 0,
                        hoverOffset: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    onClick: (evt, elements) => {
                        if (elements.length > 0) {
                            const index = elements[0].index;
                            const label = eventTypeChartInstance.data.labels[index];
                            applyFilter('type', label);
                        }
                    },
                    plugins: {
                        legend: { position: 'bottom', labels: { boxWidth: 12, padding: 15, font: { family: "'Noto Sans KR', sans-serif" } } },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return ` ${context.label}: ${context.raw}ê±´ (í´ë¦­í•˜ì—¬ í•„í„°ë§)`;
                                }
                            }
                        }
                    }
                }
            });

            // Chart 2: Timeline Density (By Century)
            const centuryCounts = {};
            dokdoData.forEach(d => {
                const century = Math.ceil(d.year / 100) + 'ì„¸ê¸°';
                centuryCounts[century] = (centuryCounts[century] || 0) + 1;
            });
            const sortedCenturies = Object.keys(centuryCounts).sort();
            const centuryData = sortedCenturies.map(c => centuryCounts[c]);

            const ctxTimeline = document.getElementById('timelineDensityChart').getContext('2d');
            timelineDensityChartInstance = new Chart(ctxTimeline, {
                type: 'bar',
                data: {
                    labels: sortedCenturies,
                    datasets: [{
                        label: 'ì£¼ìš” ì‚¬ê±´ ìˆ˜',
                        data: centuryData,
                        backgroundColor: '#d97706',
                        borderRadius: 4,
                        hoverBackgroundColor: '#b45309'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    onClick: (evt, elements) => {
                        if (elements.length > 0) {
                            const index = elements[0].index;
                            const label = timelineDensityChartInstance.data.labels[index];
                            applyFilter('century', label);
                        }
                    },
                    scales: {
                        y: { beginAtZero: true, ticks: { stepSize: 1 } },
                        x: { grid: { display: false } }
                    },
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                title: (items) => `${items[0].label} ì‚¬ê±´ ë¶„í¬`,
                                label: (context) => ` ${context.raw}ê±´ (í´ë¦­í•˜ì—¬ í•„í„°ë§)`
                            }
                        }
                    }
                }
            });
        }

        // --- EVENT HANDLERS ---
        function filterTimeline(filterType) {
            currentFilter = filterType;
            resetUIButtons(filterType);
            
            // Hide special filter display if using standard tabs
            document.getElementById('activeFilterDisplay').classList.add('hidden');
            
            renderTimeline(filterType, 'category');
        }
        
        function applyFilter(mode, value) {
            // Update UI to show we are in a special filter mode
            document.getElementById('activeFilterDisplay').classList.remove('hidden');
            document.getElementById('filterName').innerText = value;
            
            // Reset standard buttons visually
            resetUIButtons(null);
            
            renderTimeline(value, mode);
            
            // Scroll to timeline
            document.getElementById('timeline').scrollIntoView({ behavior: 'smooth' });
        }
        
        function resetFilter() {
            filterTimeline('all');
        }
        
        function resetUIButtons(activeType) {
            document.querySelectorAll('.filter-btn').forEach(btn => {
                if(btn.dataset.filter === activeType) {
                    btn.classList.add('bg-blue-900', 'text-white', 'shadow-md', 'ring-2', 'ring-offset-2', 'ring-blue-900');
                    btn.classList.remove('bg-white', 'text-stone-600', 'border', 'border-stone-300');
                } else {
                    btn.classList.remove('bg-blue-900', 'text-white', 'shadow-md', 'ring-2', 'ring-offset-2', 'ring-blue-900');
                    btn.classList.add('bg-white', 'text-stone-600', 'border', 'border-stone-300');
                }
            });
        }

        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', () => {
            // Update Stats
            document.getElementById('totalEvents').innerText = dokdoData.length;

            // Initial Renders
            renderTimeline('all');
            renderTable();
            initCharts();
            setupAnimations();

            // Search Listener
            document.getElementById('searchInput').addEventListener('input', (e) => {
                renderTable(e.target.value);
            });
        });

    </script>
</body>
</html>
